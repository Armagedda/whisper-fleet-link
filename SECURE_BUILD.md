# Secure Build & Packaging Guide for Whisper Fleet Link (Windows)

## Overview
This guide describes how to build, encrypt, sign, and package Whisper Fleet Link into a secure, production-ready Windows installer.

---

## Prerequisites
- Windows 10/11
- [Rust](https://rustup.rs/) toolchain
- [Node.js & npm](https://nodejs.org/)
- [OpenSSL for Windows](https://slproweb.com/products/Win32OpenSSL.html)
- [Inno Setup](https://jrsoftware.org/isinfo.php)
- Code signing certificate (.pfx) (optional for signing)
- Windows SDK (for signtool.exe)

---

## 1. Build & Package Steps

### a. Build and Encrypt
Run the main build script:

```powershell
powershell -ExecutionPolicy Bypass -File build/windows/build.ps1
```

This will:
- Build the backend (Rust)
- Build the frontend (Vite)
- Encrypt sensitive configs
- Generate TLS certs
- Sign the backend executable
- Package everything into a Windows installer

### b. Decrypt Configs for Runtime (if needed)
If the backend needs plaintext configs at runtime, decrypt with:

```powershell
powershell -ExecutionPolicy Bypass -File build/windows/decrypt-config.ps1
```

---

## 2. Managing Secrets & Keys
- **Never commit plaintext secrets or keys.**
- Store encryption passwords/keys in a secure vault or Windows Credential Manager.
- Rotate keys by re-encrypting configs with a new password and updating deployments.

---

## 3. Code Signing
- Obtain a code signing certificate (.pfx) from a trusted CA.
- The build script will prompt for the certificate path and password.
- Signed executables ensure integrity and trust.

---

## 4. HTTPS/TLS
- Self-signed certs are generated by default. For production, use a real CA (e.g., Let's Encrypt).
- Place cert.pem and key.pem in the backend directory.
- The backend must be configured to serve HTTPS using these certs.

---

## 5. Security Best Practices
- Only encrypted configs are packaged.
- No secrets are hardcoded or exposed in the installer.
- Use environment variables or secure stores for runtime secrets.
- Regularly audit and rotate secrets.

---

## 6. Troubleshooting
- Ensure all dependencies are installed and in PATH.
- For code signing, ensure signtool.exe is available (Windows SDK).
- For OpenSSL, ensure it's in your PATH or specify the full path in scripts.

---

## 7. Customization
- Edit `build/windows/encrypt-config.ps1` to add/remove files to encrypt.
- Edit `build/windows/package-installer.iss` to change packaging details.

---

## 8. Support
For questions, contact the project maintainer or open an issue on GitHub. 